#!/usr/bin/env bash

SESSIONS=$(tmux list-sessions | cut -d':' -f1)
TMUXINATOR=$(tmuxinator list | sed '1d' | sed 's/\s\+/\n/g')
UNION=$(cat <(echo "$SESSIONS") <(echo "$TMUXINATOR") | sort | uniq | sed "/^$/d")

SESSION=$(echo "$UNION" | dmenu -i -p "Session:" | tr -d '[[:space:]]')
[[ -n $SESSION ]] || exit


grep -Fxq "$SESSION" <(echo "$TMUXINATOR") \
    && COMMAND="tmuxinator start $SESSION" \
    || COMMAND="tmux new-session -A -s $SESSION"

urxvt -e zsh -c "source ~/.zshrc && $COMMAND"
